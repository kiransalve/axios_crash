<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crud Crud </title>
</head>

<body>
    <div>
        <header>
            <h1>Registration Form</h1>
        </header>
       <form onsubmit="savetoCrud(event)">
        <br>
        <hr>
        <br />
            <label for="name">Name : </label>
            <input type="text" name="name" id="name"><br /><br />
            <label for="email">Email : </label>
            <input type="email" name="email" id="email"><br /><br />
            <button type="submit" id="button">Submit</button>
       </form>
       <ul id="users"></ul>
    </div>
</body>

<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.0.0-alpha.1/axios.min.js"></script>

<script>

function savetoCrud(event){
    event.preventDefault();
    const name = event.target.name.value
    const email= event.target.email.value
    let url = ""

    const obj = {
        name,email
    }
    axios.post('https://crudcrud.com/api/bba6392c5cd442b591f5d1536c0f8940/appointmentData',obj) 
    .then(response => console.log(response.data)
    ).catch(error => console.log(error))
}

window.addEventListener("DOMContentLoaded", () => {
    axios.get('https://crudcrud.com/api/bba6392c5cd442b591f5d1536c0f8940/appointmentData')
    .then(
        response => {
            for(let i =0;i<response.data.length;i++){
                showUsers(response.data[i])
            }
        }
    ).catch(err => console.log(err))
})

function showUsers(user){ 
    const list = document.getElementById("users")
    const node =
    `<li id=${user._id}> ${user.name} - ${user.email}
    <button onclick=removeItems('${user._id}')> Delete </button>
    <button> Edit </button></li>`
    list.innerHTML = list.innerHTML + node
}

function removeItems(userID) {
  axios.delete(`https://crudcrud.com/api/bba6392c5cd442b591f5d1536c0f8940/appointmentData/${userID}`)
  .then(response => {
      removeUserFromScreen(userID)
  }).catch(err => console.log(err))
}

function removeUserFromScreen(userID) {
  const parentNode = document.getElementById("users");
  const childNodeToDelete = document.getElementById(userID);
  if (childNodeToDelete) {
    parentNode.removeChild(childNodeToDelete);
  }
}
</script>
</html>